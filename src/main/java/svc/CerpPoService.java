package svc;

import static db.JdbcUtil.*;
import java.sql.Connection;
import java.util.ArrayList;

import vo.BomP;
import vo.BomS;
import vo.Item;
import vo.Order;
import vo.Order2;
import vo.Order3;
import vo.Order4;
import vo.Post;
import vo.St;
import vo.User;
import vo.client;
import vo.po;
import vo.pos;
import vo.temp;
import dao.UnitedDAO;
public class CerpPoService {

	
	public User getUser(String id) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
	
		User des = CaptDao.login(id);
		System.out.println("?œ ?? ë¡œë”©");
		close(con);
		return des;
	}
	public ArrayList<po> getPoList() {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		ArrayList<po> poList = CaptDao.selectPoList(); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return poList;
	}
public Post getPost(String placecode) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		Post post = CaptDao.selectPost(placecode); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return post;
	}
	public po getPoOne(String selectpo) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		po poList = CaptDao.selectPoOne(selectpo); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return poList;
	}
public pos getPoStockOne(String selectpo, String placecode) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		pos poList = CaptDao.selectPoStockOne(selectpo,placecode); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return poList;
	}
	public ArrayList<pos> getPoStockList(String selectpostock) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		ArrayList<pos> posList = CaptDao.selectPoStockList(selectpostock); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return posList;
	}
	public boolean updatePoStock(String placecode, String itemcode,int materials, String clientname) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.updatePoStock(placecode,itemcode,materials,clientname); 
		close(con);
		return success;
	}
	public boolean updatePo(String placecode, String warename,String orderday, String deliveryday, String ecode, String ename) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.updatePo(placecode,warename,orderday,deliveryday,ecode,ename); 
		close(con);
		return success;
	}
	public boolean updatePost(String placecode, String warename,String tempware, String defectware) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.updatePost(placecode,warename,tempware,defectware); 
		close(con);
		return success;
	}
	public boolean insertPo(String warename, String orderday,String delivery_day, int sv, int total_amount, String ecode, String ename,String ordercode) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.insertPo(warename,orderday,delivery_day,sv,total_amount,ecode,ename,ordercode); 
		close(con);
		return success;
	}
	public boolean insertPost(String ordercode,String warename, String tempname,String defectname) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.insertPost(ordercode,warename,tempname,defectname); 
		close(con);
		return success;
	}
	public ArrayList<Order2> getOrderList() {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		ArrayList<Order2> orderList = CaptDao.selectOrderList2(); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return orderList;
	}
public Order2 getOrderOne(String ordercode) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		Order2 orderList = CaptDao.selectOrderOne(ordercode); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return orderList;
	}
public ArrayList<temp> getMRP(String itemname, String needHolding) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		ArrayList<temp> mrplist = CaptDao.getMRP(itemname, needHolding); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return mrplist;
	}
public int getsv(String itemname, String needHolding) {
	
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	
	int sv = CaptDao.getsv(itemname, needHolding); 
	close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
	return sv;
}
public temp getMrpOne(String selecttemp) {
	
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	
	temp temp = CaptDao.selectMrpOne(selecttemp); 
	close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
	return temp;
}
public boolean updateTemp(String itemcode,int materials, String clientname) {
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	

	boolean success = CaptDao.updateTemp(itemcode,materials,clientname); 
	close(con);
	return success;
}
public void resetmrp() {
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	

	CaptDao.resetmrp(); 
	close(con);
	return;
}
	public boolean DeleteFromStock(String bom_code, String itemcode) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		boolean success = CaptDao.deleteFromStock(bom_code,itemcode); 
		close(con);
		return success;
	}
	public String selectItemNameOne(String itemcode) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		String success = CaptDao.selectItemNameOne(itemcode); 
		close(con);
		return success;
	}
	public int selectMaterials(String bom_code, String itemcode) {
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	

		int success = CaptDao.selectMaterials(bom_code,itemcode); 
		close(con);
		return success;
	}
public ArrayList<Item> getItemNotInList(String bom_code,String itemcode) {
		
		Connection con = getConnection();
		UnitedDAO CaptDao = UnitedDAO.getInstance();
		CaptDao.setConnection(con);	
		
		ArrayList<Item> itemList = CaptDao.selectItemNotInList(bom_code,itemcode); 
		close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
		return itemList;
	}
public ArrayList<Item> getProductNotInList() {
	
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	
	ArrayList<Item> itemList = CaptDao.selectProductNotInList(); 
	close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
	return itemList;
}


public boolean InsertBomStock(String bom_code, String itemcode, String itemname, int materials) {
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	

	boolean success = CaptDao.insertBomStock(bom_code,itemcode,itemname,materials); 
	close(con);
	return success;
	}
public boolean InsertBomBase(String itemcode, String itemname) {
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	

	boolean success = CaptDao.insertBomBase(itemcode,itemname); 
	close(con);
	return success;
	}
public ArrayList<St> getWareListStock() {
	
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	
	ArrayList<St> stList = CaptDao.selectStListStock(); 
	close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
	return stList;
}
public ArrayList<St> getWareListTemp() {

Connection con = getConnection();
UnitedDAO CaptDao = UnitedDAO.getInstance();
CaptDao.setConnection(con);	

ArrayList<St> stList = CaptDao.selectStListTemp(); 
close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
return stList;
}
public ArrayList<St> getWareListDefect() {

Connection con = getConnection();
UnitedDAO CaptDao = UnitedDAO.getInstance();
CaptDao.setConnection(con);	

ArrayList<St> stList = CaptDao.selectStListdefect(); 
close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
return stList;
}

public ArrayList<po> getPoSearchList(String searchoption,String firstdate,String finaldate,String progress,String searchvalue,String firstdate2,String finaldate2) {
	
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	
	ArrayList<po> poList = CaptDao.selectPoSearchList(searchoption,firstdate,finaldate,progress,searchvalue,firstdate2,finaldate2); 
	close(con); // ï¿½Ú¿ï¿½ ï¿½ï¿½ï¿½ï¿½
	return poList;
}
public Order4 SVPOTaxbillorder(String placecode) {
	Connection con = getConnection();
	UnitedDAO CaptDao = UnitedDAO.getInstance();
	CaptDao.setConnection(con);	
	System.out.println("cerporderservice¿¡¼­ order4 getupdateorder2½ÇÇà");
	Order4 taxbillorder = CaptDao.potaxbillOrder(placecode); 
	close(con);
	return taxbillorder;
}
}
